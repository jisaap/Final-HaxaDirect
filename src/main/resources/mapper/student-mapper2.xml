<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="student2">
	
	<!-- 서브퀴리를 통해 이수구분을 받아오는 HD_SUBJECT_TB에서 과목종류 SUB_TYPE, 이수학점 COMPLETE_PT 을 조회해와야한다. -->
	<select id="selectGradeList" parameterType="string" resultMap="GradeResult">
		SELECT A.*, B.SUB_TYPE FROM HD_GRADE_TB A JOIN (SELECT SUB_CODE, SUB_TYPE FROM HD_SUBJECT_TB) B ON (A.SUB_CODE = B.SUB_CODE) WHERE STU_NO=#{stuNo} ORDER BY ACA_YEAR_SEM DESC, SUB_NAME ASC
	</select>
	<select id="selectGradeListSubType" parameterType="string" resultType="map">
		select stu_no,aca_year_sem, sum(rcv_credits), sub_type 
		from hd_grade_tb join hd_subject_tb using (sub_code) 
		group by (stu_no, aca_year_sem, sub_type) having stu_no=#{stuNo}	
	</select>
	
	
	
	<!-- resultMap에 개념은 vo객체와 DB에 있는 컬럼명이 맞지 않을경우 매칭이 안되므로 그 매칭을 해주기 위해 설정 해주는 것. -->
	<resultMap type="grade" id="GradeResult">
		<!-- typeHandler="" 은 뭐지? -->
		<result column="ACA_YEAR_SEM" property="acaYearSem"/>
		<result column="SUB_CODE" property="subCode"/>
		<result column="SUB_NAME" property="subName"/>
		<result column="PROF_ID" property="profId"/>
		<result column="MTERM" property="mterm"/>
		<result column="FTERM" property="fterm"/>
		<result column="ASSIGN_1" property="assign1"/>
		<result column="ASSIGN_2" property="assign2"/>
		<result column="ASSIGN_3" property="assign3"/>
		<result column="ASSIGN_4" property="assign4"/>
		<result column="GRADE" property="grade"/>
		<result column="STU_NO" property="stuNo"/>
		<result column="RETAKE" property="retake"/>
		<result column="RCV_CREDITS" property="rcvCredits"/>
		<result column="SUB_TYPE" property="subType"/>
	</resultMap>
	


  
</mapper>
